INCLUDE<P16F877A.INC>
__config H'3F31'

SAYAC EQU 0X25
SAY EQU 0X26
LED1 EQU 0X27
LED2 EQU 0X28
ORG 0X00
goto anaprogram

ORG 0X04
KESME
BTFSS PIR1,TMR1IF
RETFIE
BCF PIR1,TMR1IF
MOVLW 0X3C
MOVWF TMR1H
MOVLW 0XB0
MOVWF TMR1L
INCF SAYAC
MOVF SAYAC,W
SUBLW D'1'			;1 saniye olmasý için gereken sayac
BTFSS STATUS,Z
RETFIE
CLRF SAYAC		;Display1 1 artýrýldý
DECFSZ LED1,F
RETFIE
CALL AZALT
RETFIE

AZALT
DECF LED2
MOVLW D'10'
MOVWF LED1
BTFSS STATUS,Z
RETURN
MOVLW D'6'
MOVWF LED2
RETURN


anaprogram
BANKSEL TRISB
CLRF TRISB
CLRF TRISA
BANKSEL PORTB
CLRF PORTB
CLRF SAYAC
CLRF LED1
CLRF LED2

MOVLW D'10'
MOVWF LED1
MOVLW D'6'
MOVWF LED2

BANKSEL T1CON
MOVLW B'00100001'  ;Prescaler 1:4 
MOVWF T1CON
BANKSEL TMR1H
MOVLW 0x3C		;TMR1=15.536 50.000 SAYAR
MOVWF TMR1H
MOVLW 0XB0
MOVWF TMR1L		;
BANKSEL PIR1
BCF PIR1,TMR1IF	
BANKSEL PIE1
BSF INTCON,GIE
BSF INTCON,PEIE
BSF PIE1,TMR1IE		;Tmr1 saymaya basladý
BANKSEL PORTB

KESMEBEKLE
MOVLW D'2'
MOVWF PORTA
MOVF LED1,W
CALL LUKETABLE
MOVWF PORTB
CALL GECIKME		;Supurme olayý

MOVLW D'1'
MOVWF PORTA
MOVF LED2,W
CALL LUKETABLE
MOVWF PORTB
CALL GECIKME
GOTO KESMEBEKLE


GECIKME
MOVLW D'255'
MOVWF SAY
DECFSZ SAY,F
GOTO $-1
RETURN


LUKETABLE
ADDWF PCL,F
RETLW B'00111111'  ;0  
RETLW B'00111111'  ;0  
RETLW B'00000110'  ;1
RETLW B'01011011'  ;2
RETLW B'01001111'  ;3
RETLW B'01100110'  ;4
RETLW B'01101101'  ;5
RETLW B'01111101'  ;6
RETLW B'00000111'  ;7
RETLW B'01111111'  ;8
RETLW B'01101111'  ;9  
RETURN



END