INCLUDE<P16F877A.INC>
__config H'3F31'

SAYAC EQU 0X25
SAY EQU 0X27
LED1 EQU 0X28
LED2 EQU 0X29
LED1DEGER EQU 0X30
LED2DEGER EQU 0X31
ORG 0X00
goto anaprogram

ORG 0X04
KESME
BTFSS PIR1,TMR1IF
RETFIE
BCF PIR1,TMR1IF
MOVLW 0X3C
MOVWF TMR1H
MOVLW 0XB0
MOVWF TMR1L
INCF SAYAC
MOVF SAYAC,W
SUBLW D'5'			;1 saniye olmasý için gereken sayac
BTFSS STATUS,Z
RETFIE
INCF LED1			;Display 1 artýrýldý
MOVF LED1,W
CALL LUKETABLE
MOVWF LED1DEGER
CLRF SAYAC
MOVF LED1,W
SUBLW D'10'
BTFSS STATUS,Z		;0-9 dan sonra soldaki display 
RETFIE				;1 artýrýldý
INCF LED2
MOVF LED2,W
CALL LUKETABLE
MOVWF LED2DEGER
CLRF LED1
MOVLW D'0'
CALL LUKETABLE		
MOVWF LED1DEGER
RETFIE


anaprogram
BANKSEL TRISB
CLRF TRISB
CLRF TRISA
BANKSEL PORTB
CLRF PORTB
CLRF SAYAC
CLRF LED1
CLRF LED2
MOVLW D'0'
CALL LUKETABLE
MOVWF LED1DEGER		;Baslangýcda 00 yazsýn diye
MOVWF LED2DEGER

BANKSEL T1CON
MOVLW B'00100001'  ;Prescaler 1:4 
MOVWF T1CON
BANKSEL TMR1H
MOVLW 0x3C		;TMR1=15.536 50.000 SAYAR
MOVWF TMR1H
MOVLW 0XB0
MOVWF TMR1L		;
BANKSEL PIR1
BCF PIR1,TMR1IF	
BANKSEL PIE1
BSF INTCON,GIE
BSF INTCON,PEIE
BSF PIE1,TMR1IE		;Tmr1 saymaya basladý
BANKSEL PORTB

KESMEBEKLE
MOVLW D'2'
MOVWF PORTA
MOVF LED1DEGER,W
MOVWF PORTB
CALL GECIKME		;Supurme olayý

MOVLW D'1'
MOVWF PORTA
MOVLW d'6'
SUBWF LED2,W
BTFSS STATUS,Z		;6 kontrolu tekrar 0 don
GOTO LED2YAK
MOVLW B'00111111'
MOVWF LED2DEGER
CLRF LED2
LED2YAK
MOVF LED2DEGER,W
MOVWF PORTB
CALL GECIKME
GOTO KESMEBEKLE


GECIKME
MOVLW D'255'
MOVWF SAY
DECFSZ SAY,F
GOTO $-1
RETURN


LUKETABLE
ADDWF PCL,F
RETLW B'00111111'  ;0  
RETLW B'00000110'  ;1
RETLW B'01011011'  ;2
RETLW B'01001111'  ;3
RETLW B'01100110'  ;4
RETLW B'01101101'  ;5
RETLW B'01111101'  ;6
RETLW B'00000111'  ;7
RETLW B'01111111'  ;8
RETLW B'01101111'  ;9
RETURN



END